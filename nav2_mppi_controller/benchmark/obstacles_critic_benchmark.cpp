// Copyright (c) 2024 OTSAW

#include <benchmark/benchmark.h>
#include <string>

#include "gtest/gtest.h"
#include <geometry_msgs/msg/pose_stamped.hpp>
#include <geometry_msgs/msg/twist.hpp>
#include <nav_msgs/msg/path.hpp>

#include <nav2_costmap_2d/cost_values.hpp>
#include <nav2_costmap_2d/costmap_2d.hpp>
#include <nav2_costmap_2d/costmap_2d_ros.hpp>
#include <nav2_core/goal_checker.hpp>
#include <tf2/LinearMath/Quaternion.h>

#include <xtensor/xarray.hpp>
#include <xtensor/xio.hpp>
#include <xtensor/xview.hpp>

#include "nav2_mppi_controller/optimizer.hpp"
#include "nav2_mppi_controller/motion_models.hpp"

#include "nav2_mppi_controller/tools/parameters_handler.hpp"

#include "utils.hpp"

class RosLockGuard
{
public:
  RosLockGuard() {rclcpp::init(0, nullptr);}
  ~RosLockGuard() {rclcpp::shutdown();}
};

RosLockGuard g_rclcpp;

void prepareAndRunBenchmark(
  bool consider_footprint, std::string motion_model,
  std::vector<std::string> critics, benchmark::State & state, bool use_gpu)
{
  int batch_size = 2000;
  int time_steps = 54;
  unsigned int path_points = 50u;
  int iteration_count = 1;
  double lookahead_distance = 10.0;

  // Init Costmap node
  auto costmap_ros = std::make_shared<nav2_costmap_2d::Costmap2DROS>("cost_map_node");
  costmap_ros->declare_parameter("inflation_layer.inflation_radius", 0.6);
  costmap_ros->declare_parameter("inflation_layer.cost_scaling_factor", 1.0);
  costmap_ros->on_configure(rclcpp_lifecycle::State{});

  unsigned int cells_x = 90;
  unsigned int cells_y = 90;
  double origin_x = -13.4;
  double origin_y = -90.8;
  double resolution = 0.1;
  unsigned char cost_map_default_value = 0;
  auto tmp = std::make_shared<nav2_costmap_2d::Costmap2D>(
    cells_x, cells_y, resolution, origin_x, origin_y, cost_map_default_value);

  auto costmap_ptr = costmap_ros->getCostmap();
  *(costmap_ptr) = *tmp;

  std::vector<geometry_msgs::msg::Point> footprint {
    getDummyPoint(0.8616, 0.338),
    getDummyPoint(-0.433, 0.338),
    getDummyPoint(-0.433, -0.338),
    getDummyPoint(0.8616, -0.338)
  };
  costmap_ros->setRobotFootprint(footprint);
  auto costmap = costmap_ros->getCostmap();

  // addObstacle
  unsigned char test_costmap[] = {
    0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 167, 167, 167, 167, 167, 167, 167, 185, 204, 226, 250, 253, 254, 254, 253, 254, 254, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 185, 185, 185, 185, 185, 185, 185, 185, 195, 204, 226, 250, 253,254, 254, 254, 254, 254, 253, 253, 244, 222, 202, 183, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 204, 204, 204, 204, 204, 204, 204, 204, 213, 222, 226, 250, 253, 254, 254, 253, 254, 254, 253, 253, 244, 222, 202, 183, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 226, 226, 226, 226, 226, 226, 226, 226, 230, 244, 250, 250, 253, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 170, 178, 183, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 250, 250, 250, 250, 250, 250, 250, 250, 250, 253, 253, 253, 253, 254, 254, 253, 254, 254,254, 253, 250, 226, 204, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 195, 202, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 253, 254, 254, 253, 254, 254, 254, 253, 250, 226, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 213, 222, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 230, 244, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253,253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250,250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 253, 254, 253, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 250, 253, 254, 253, 250, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 253, 254, 254, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 253, 250, 226, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204,204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 226, 250, 253, 254, 253, 250, 226, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 253, 253, 253, 253, 250, 250, 250, 250, 250, 250, 250, 250, 250, 253, 253, 254, 254, 254, 253, 253, 244, 222, 202, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 185, 185, 185, 185, 185, 185, 185, 185, 244, 250, 250, 244, 230, 226, 226, 226, 226, 226, 226, 226, 230, 244, 253, 253, 253, 253, 253, 244, 230, 213, 195, 178, 167, 167, 167, 167, 167,167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 167, 167, 167, 167, 167, 167, 222, 226, 226, 222, 213, 204, 204, 204, 204, 204, 204, 204, 213, 230, 244, 250, 250, 250, 244, 230, 213, 199, 185, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 202, 204, 204,202, 195, 185, 185, 185, 185, 185, 185, 185, 199, 213, 222, 226, 226, 226, 222, 213, 199, 185, 173, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 170, 178, 183, 185, 183, 178, 170, 0, 0, 0, 0, 0, 0, 170, 178, 183, 185, 183, 178, 170, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167,0, 0, 0, 0, 0, 0, 0, 183, 185, 185, 183, 178, 170, 167, 167, 167, 167, 167, 173, 185, 195, 202, 204, 204, 204, 202, 195, 185, 173, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 173, 185, 195, 202, 204, 202, 195, 185, 173, 0, 0, 0, 0, 173, 185, 195, 202, 204, 202, 195, 185, 173, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 167, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 170, 178, 183, 185, 185, 185, 183, 178, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 170, 185, 199, 213, 222, 226, 222, 213, 199, 185, 170, 0, 0, 170, 185, 199, 213, 222, 226, 222, 213, 199, 185, 170, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 167, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 178, 195, 213, 230, 244, 250, 244, 230, 213, 195, 178, 0, 0, 178, 195, 213, 230, 244, 250, 244, 230, 213, 195, 178, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 183, 202, 222, 244, 253, 253, 253, 244, 222, 202, 183, 0, 0, 183, 202, 222, 244, 253, 253, 253,244, 222, 202, 183, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167,167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185,167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 167, 167, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 170, 178, 183, 185, 185, 185, 185, 183, 178, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 173, 185, 195, 202, 204, 204, 204, 204, 202, 195, 185, 173, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 183, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 199, 213, 222, 226, 226, 226, 226, 222, 213, 199, 185, 173, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 202, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 213, 230, 244, 250, 250, 250, 250, 244, 230, 213, 199, 185, 173, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 222, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 244, 253, 253, 253, 253, 253, 253, 244, 230, 213, 199, 185, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 244, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 253, 254, 254, 254, 254, 253, 253, 244, 230, 213, 195, 178, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 253, 253, 244, 222, 202, 185, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 230, 213, 195, 178, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 253, 244, 222, 202, 183, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 183, 178, 170, 0, 0,0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253,250, 230, 213, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 202, 195, 185, 173, 0, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 253, 244, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 222, 213, 199, 185, 170, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 244, 230, 213, 195, 178, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 244, 222, 202, 183, 0, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254,253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254,253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250,226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250,226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250,226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250,226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 244, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 230, 244, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 213, 222, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 226, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 195, 202, 204, 204, 204, 204, 204, 204, 204, 204, 204, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 178, 183, 185, 185, 185, 185, 185, 185, 185, 185, 185, 202, 222, 244, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 167, 167, 167, 167, 167, 167, 167, 178, 195, 213, 230, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 183, 202, 222, 244, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 183, 202, 222, 244, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 178, 195, 213, 230, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254,254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 183, 202, 222, 244, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204,185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 183, 202, 222, 244, 253, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 178, 195, 213, 230, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 170, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,167, 185, 204, 226, 250, 253, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 167, 185, 204, 226, 250, 253, 254, 253, 250, 226, 204, 185, 167, 0, 0, 0, 0, 0, 0, 0
  };
  for (unsigned int i=0; i < 90*90; i++) {
    unsigned int mx, my;
    costmap->indexToCells(i, mx, my);
    costmap->setCost(mx, my, test_costmap[i]);
  }

  // init pose
  TestPose start_pose = {-9.0, -86.4};

  double path_x_step = 0.0;
  double path_y_step = 0.1;

  TestPathSettings path_settings{start_pose, path_points, path_x_step, path_y_step};
  TestOptimizerSettings optimizer_settings{batch_size, time_steps, iteration_count,
    lookahead_distance, motion_model, consider_footprint};

  printInfo(optimizer_settings, path_settings, critics);

  std::string node_name("controller_server_node");

  std::vector<rclcpp::Parameter> params {
    rclcpp::Parameter(node_name + ".iteration_count", optimizer_settings.iteration_count),
    rclcpp::Parameter(node_name + ".batch_size", optimizer_settings.batch_size),
    rclcpp::Parameter(node_name + ".time_steps", optimizer_settings.time_steps),
    rclcpp::Parameter(node_name + ".lookahead_dist", optimizer_settings.lookahead_distance),
    rclcpp::Parameter(node_name + ".motion_model", optimizer_settings.motion_model),
    rclcpp::Parameter(node_name + ".critics", critics),
    rclcpp::Parameter(node_name + ".ObstaclesCritic.consider_footprint", optimizer_settings.consider_footprint),
    rclcpp::Parameter(node_name + ".ObstaclesCritic.use_gpu", use_gpu),
    rclcpp::Parameter("controller_frequency", 50.0)
  };
  rclcpp::NodeOptions options;
  options.parameter_overrides(params);

  auto node = std::make_shared<rclcpp_lifecycle::LifecycleNode>(node_name, options);

  auto parameters_handler = std::make_unique<mppi::ParametersHandler>(node);
  auto optimizer = getDummyOptimizer(node, costmap_ros, parameters_handler.get());

  // evalControl args
  auto pose = getDummyPointStamped(node, start_pose);
  tf2::Quaternion q;
  q.setRPY(0, 0, 1.57);
  pose.pose.orientation.x = q.x();
  pose.pose.orientation.y = q.y();
  pose.pose.orientation.z = q.z();
  pose.pose.orientation.w = q.w();

  auto velocity = getDummyTwist();
  
  auto path = getIncrementalDummyPath(node, path_settings);
  nav2_core::GoalChecker * dummy_goal_checker{nullptr};
  

  for (auto _ : state) {
    optimizer->evalControl(pose, velocity, path, dummy_goal_checker);
  }
}

static void BM_ObstaclesCriticCPU(benchmark::State & state)
{
  bool consider_footprint = true;
  bool use_gpu = false;
  std::string motion_model = "DiffDrive";
  std::vector<std::string> critics = {{"ObstaclesCritic"}};
  prepareAndRunBenchmark(consider_footprint, motion_model, critics, state, use_gpu);
}

static void BM_ObstaclesCriticGPU(benchmark::State & state)
{
  bool consider_footprint = true;
  bool use_gpu = true;
  std::string motion_model = "DiffDrive";
  std::vector<std::string> critics = {{"ObstaclesCritic"}};
  prepareAndRunBenchmark(consider_footprint, motion_model, critics, state, use_gpu);
}

BENCHMARK(BM_ObstaclesCriticCPU)->Unit(benchmark::kMillisecond);
BENCHMARK(BM_ObstaclesCriticGPU)->Unit(benchmark::kMillisecond);

BENCHMARK_MAIN();
